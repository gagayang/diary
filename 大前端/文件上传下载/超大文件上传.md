## 超大文件上传 http方案

推荐文章：

[https://cloud.tencent.com/developer/article/1571358](https://cloud.tencent.com/developer/article/1571358)

在http协议下，我们无法保持浏览器与服务端的长连接，所以不能以文件流的形式来提交文件，如果要用http实现分片上传，那么只能前端先分割，在一个一个上传，比如10M文件，就会用http发起10次请求

其次是文件片的保存与追加，我后台用PHP写的，先用file_get_contents获取文件的二进制格式，再用file_put_contents每次将文件追加

接下来我们还需要实时保存已上传文件的大小，以便于下次上传前进行正确切割。使用HTML5的localStorage是一种方法，将已上传的大小保存在本地，下次上传前先从本地读取。不过这种方式是很局限的，抛开用户可能通过各种管家清除掉本地数据不讲，假如用户在A页面上传了一个文件的50%，然后在B页面想把该文件上传到另外一个地方，结果从本地一读文件已上传50%了，直接从51%的位置开始上传了，显然是个错误。问题就在于本地不能存太多的信息，通过File API只能获取到文件的原始名称，无法正确的与服务器上的文件正确匹配。所以真正在项目中用，还得依靠服务端来保存这些数据。
